digraph G {
    {node[color=red];"Data loader"} -> {node[color=green];"group_wksp is None?"};
    {node[color=green];"group_wksp is None?"} -> "Summed cache exist?" [label="  Yes"];
    "Summed cache exist?" -> "Load summed cache" [label="  Yes"];
    "Load summed cache" -> "Normalize by current";
    "Normalize by current" -> "Return summed wksp";
    "Summed cache exist?" -> "For run in runs" [label="  No"];
    "For run in runs" -> "Run cache exists?";
    "Run cache exists?" -> "Load run cache" [label="  Yes"];
    "Load run cache" -> "Accumulate run into runs";
    "Accumulate run into runs" -> "Save summed cache";
    "Run cache exists?" -> "Align and focus run" [label="  No"];
    "Align and focus run" -> "Convert unit to Q";
    "Convert unit to Q" -> "Rebin";
    "Rebin" -> "Save run cache";
    "Save run cache" -> "Accumulate run into runs";
    "Accumulate run into runs" -> "For run in runs";
    "Save summed cache" -> "Normalize by current";
    {node[color=green];"group_wksp is None?"} -> {node[label="For run in runs"];loop_runs_1} [label="  No"];
    {node[label="For run in runs"];loop_runs_1} -> {node[label="Group run cache exists?"];"group_run_exists_1"};
    {node[label="Group run cache exists?"];"group_run_exists_1"} -> "Load group run cache" [label="  Yes"];
    {node[label="group_wksp";color=green];group_wksp_3} -> {node[label="Align and focus run"];"align_focus_2"};
    {node[label="Group run cache exists?"];"group_run_exists_1"} -> {node[label="Align and focus run"];"align_focus_2"} [label="  No"];
    {node[label="Align and focus run"];"align_focus_2"} -> {node[label="Rebin"];"rebin_2"};
    {node[color=green];"Proper TOF bin params"} -> {node[label="Rebin"];"rebin_2"};
    {node[label="Rebin"];"rebin_2"} -> {node[label="Convert unit to wavelength"];"convert_unit_w_1"};
    {node[label="Convert unit to wavelength"];"convert_unit_w_1"} -> {node[label="Save group run cache"];"save_group_run_1"};
    "Load group run cache" -> "Accumulate group run to runs";
    {node[label="Save group run cache"];"save_group_run_1"} -> "Accumulate group run to runs";
    "Accumulate group run to runs" -> {node[label="For run in runs"];loop_runs_1};
    {node[label="Absorption sksp";color=green];"abs_wksp_input_1"} -> "Valid absorption wksp?";
    "Accumulate group run to runs" -> "Valid absorption wksp?";
    "Valid absorption wksp?" -> "Rebin abs wksp to runs wksp" [label="  Yes"];
    "Rebin abs wksp to runs wksp" -> "Divide runs over abs wksp";
    "Divide runs over abs wksp" -> "Generate spec-ID to index map";
    "Valid absorption wksp?" -> "Generate spec-ID to index map" [label="  No"];
    "Generate spec-ID to index map" -> "Generate output group pattern";
    "Generate output group pattern" -> {node[label="Convert unit to Q"];"convert_to_q_1"};
    {node[label="Convert unit to Q"];"convert_to_q_1"} -> {node[label="Rebin to fine Q grid"];"rebin_to_fine_q_grid"};
    {node[color=green];"Fine Q grid params"} -> {node[label="Rebin to fine Q grid"];"rebin_to_fine_q_grid"};
    {node[label="Rebin to fine Q grid"];"rebin_to_fine_q_grid"} -> "Group detectors";
    "Group detectors" -> "Normalize by current";
}